<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>Teams Transcription</title>
</head>

<body>
    <div>
        Status:
        <span id="status">disconnected</span>
    </div>

    <div id="container" style="width: 100%; height: 400px; border: solid grey 1px; border-radius: 5px; overflow: auto"></div>

    <script type="text/javascript">

        const container = document.getElementById("container");
        const status = document.getElementById("status");

        function showStatus(x) {
            status.innerHTML = x;
        }

        function showMessage(text) {
            const e = document.createElement("div");
            e.innerHTML = text;
            container.appendChild(e);
        };

        function createWebSocket() {
            const ws = new WebSocket("ws://teams.featherinthecap.com:8080");
            ws.onopen = () => showStatus("connected");
            ws.onclose = () => showStatus("disconnected");
            ws.onmessage = function (evt) {
                console.log({ evt });
                const { data } = evt;
                (data !== 'welcome') && showMessage(data);
            };
        }

        createWebSocket();
    </script>

</body>
</html>